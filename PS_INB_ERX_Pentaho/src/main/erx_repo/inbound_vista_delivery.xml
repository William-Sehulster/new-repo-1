<?xml version="1.0" encoding="UTF-8"?>
<repository>

<transformations>
<transformation>
  <info>
    <name>IBDTV_SendMessageToVistaMbM_TRN</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/inbound_vista_delivery</directory>
    <parameters>
      <parameter>
        <name>INBOUND_NCPDP_MSG_ID</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>RETRY</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>RUNCOUNT</name>
        <default_value/>
        <description/>
      </parameter>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
      <slaveserver>
        <name>master1</name>
        <hostname>localhost</hostname>
        <port>8080</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>slave3</name>
        <hostname>vaauserxappsqa2.aac.va.gov</hostname>
        <port>8083</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>slave5</name>
        <hostname>vaauserxappsqa2.aac.va.gov</hostname>
        <port>8085</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>admin</created_user>
    <created_date>2017/03/26 23:43:30.000</created_date>
    <modified_user>admin</modified_user>
    <modified_date>2020/12/08 09:08:58.000</modified_date>
    <key_for_session_key/>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>local_erx</name>
    <server>${DB_HOST_NAME}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${DB_NAME}</database>
    <port>${DB_PORT}</port>
    <username>${DB_USERNAME}</username>
    <password>${DB_PASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>INITIAL_POOL_SIZE</code>
        <attribute>1</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MAXIMUM_POOL_SIZE</code>
        <attribute>10</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${DB_PORT}</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>Y</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Set MESSAGE to ERROR</from>
      <to>Get Date_Time</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Format Date-Time</from>
      <to>Generate random value</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>check for retry</from>
      <to>To Vista Check Failure Allow Retry</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Date_Time</from>
      <to>Format Date-Time</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Concat Date-Time and Random Value for New Message ID</from>
      <to>Write to log 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Inject Values into NCPDP Error Message Template</from>
      <to>Insert to OUTBOUND_NCPDP_MSG</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JSON Input 2</from>
      <to>Write to log</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Concat Date-Time and Random Value for New Message ID</from>
      <to>Inject Values into NCPDP Error Message Template</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Generate random value</from>
      <to>ABS</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>ABS</from>
      <to>Concat Date-Time and Random Value for New Message ID</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set MESSAGE_TYPE to ERROR</from>
      <to>Set MESSAGE to ERROR</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>check for retry</from>
      <to>To Vista Check Failure</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set MESSAGE to VERIFY</from>
      <to>Get Date_Time</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>To Vista Check Success</from>
      <to>Switch / Case Send Verify or Not</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case Send Verify or Not</from>
      <to>Set MESSAGE_TYPE to Verify</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case Send Verify or Not</from>
      <to>Don't Generate a Verify</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JSON Input 2</from>
      <to>Set Success values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set Success values</from>
      <to>check for success</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>To Vista Check Failure</from>
      <to>Switch/Case Error, Status, Verify?</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch/Case Error, Status, Verify?</from>
      <to>No Error on Error, Status, Verify</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch/Case Error, Status, Verify?</from>
      <to>Set MESSAGE_TYPE to ERROR</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>check for success</from>
      <to>remove special chars from errorMessage</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>remove special chars from errorMessage</from>
      <to>To Vista Check Failure</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set MESSAGE_TYPE to Verify</from>
      <to>Set MESSAGE to VERIFY</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>REST Client</from>
      <to>Replace null with "</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Replace null with "</from>
      <to>JSON Input 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Table input</from>
      <to>Set Message Status to Processing</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set Message Status to Processing</from>
      <to>REST Client</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>check for success</from>
      <to>To Vista Check Success</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JSON Input 2</from>
      <to>check for retry</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>REST Client</from>
      <to>check for retry</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>ABS</name>
    <type>Calculator</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <failIfNoFile>N</failIfNoFile>
    <calculation>
      <field_name>MESSAGE_ID3</field_name>
      <calc_type>ABS</calc_type>
      <field_a>MESSAGE_ID2</field_a>
      <field_b/>
      <field_c/>
      <value_type>Integer</value_type>
      <value_length>-1</value_length>
      <value_precision>-1</value_precision>
      <remove>N</remove>
      <conversion_mask>0</conversion_mask>
      <decimal_symbol>.</decimal_symbol>
      <grouping_symbol>,</grouping_symbol>
      <currency_symbol/>
    </calculation>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1328</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Concat Date-Time and Random Value for New Message ID</name>
    <type>ConcatFields</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <separator>.0</separator>
    <enclosure/>
    <enclosure_forced>N</enclosure_forced>
    <enclosure_fix_disabled>N</enclosure_fix_disabled>
    <header>N</header>
    <footer>N</footer>
    <format>DOS</format>
    <compression>None</compression>
    <encoding/>
    <endedLine/>
    <fileNameInField>N</fileNameInField>
    <fileNameField/>
    <create_parent_folder>Y</create_parent_folder>
    <file>
      <name/>
      <servlet_output>N</servlet_output>
      <do_not_open_new_file_init>N</do_not_open_new_file_init>
      <extention>txt</extention>
      <append>N</append>
      <split>N</split>
      <haspartno>N</haspartno>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <add_to_result_filenames>Y</add_to_result_filenames>
      <pad>N</pad>
      <fast_dump>N</fast_dump>
      <splitevery/>
    </file>
    <fields>
      <field>
        <name>MESSAGE_ID_DATETIME</name>
        <type>None</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>MESSAGE_ID3</name>
        <type>None</type>
        <format>0000000000</format>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
    </fields>
    <ConcatFields>
      <targetFieldName>MESSAGE_ID_NEW_1</targetFieldName>
      <targetFieldLength>35</targetFieldLength>
      <removeSelectedFields>N</removeSelectedFields>
    </ConcatFields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1056</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Don't Generate a Verify</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>944</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Format Date-Time</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>
var d = new Date();

var output = date2str(TODAY_DATE_TIME, "MMddyyyy.HH.mm.sss");

var output2 = d.toISOString();

</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>output</name>
        <rename>MESSAGE_ID_DATETIME</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>output2</name>
        <rename>MESSAGE_SENT_DATETIME2</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Generate random value</name>
    <type>RandomValue</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>MESSAGE_ID2</name>
        <type>random integer</type>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1328</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Date_Time</name>
    <type>SystemInfo</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>TODAY_DATE_TIME</name>
        <type>system date (variable)</type>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>976</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Inject Values into NCPDP Error Message Template</name>
    <type>ReplaceString</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_to}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>CLINIC_ID</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_from}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>PHARMACY_NCPDPID</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_message_id}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>MESSAGE_ID_NEW_1</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_relates_to_message_id}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>MESSAGE_ID</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_sent_time}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>MESSAGE_SENT_DATETIME2</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_error_code}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>ERROR_CODE</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_description_code}</replace_string>
        <replace_by_string>007</replace_by_string>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string/>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_description}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>ERROR_DESC</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>688</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert to OUTBOUND_NCPDP_MSG</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>local_erx</connection>
    <execute_each_row>Y</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>N</replace_variables>
    <quoteString>N</quoteString>
    <sql>insert into outbound_ncpdp_msg (message_id,rel_to_message_id,  message, message_type, message_status, pharmacy_id,received_date,script_version)
values ('?','?','?','?','0000','?', SYSDATE, 2017071);
commit;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
      <argument>
        <name>MESSAGE_ID_NEW_1</name>
      </argument>
      <argument>
        <name>MESSAGE_ID</name>
      </argument>
      <argument>
        <name>MESSAGE</name>
      </argument>
      <argument>
        <name>MESSAGE_TYPE</name>
      </argument>
      <argument>
        <name>PHARMACY_ID</name>
      </argument>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>JSON Input 2</name>
    <type>JsonInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <include>N</include>
    <include_field/>
    <rownum>N</rownum>
    <addresultfile>N</addresultfile>
    <readurl>N</readurl>
    <removeSourceField>N</removeSourceField>
    <IsIgnoreEmptyFile>Y</IsIgnoreEmptyFile>
    <doNotFailIfNoFile>Y</doNotFailIfNoFile>
    <ignoreMissingPath>N</ignoreMissingPath>
    <defaultPathLeafToNull>Y</defaultPathLeafToNull>
    <rownum_field/>
    <file>
      <name/>
      <filemask/>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
    </file>
    <fields>
      <field>
        <name>success</name>
        <path>success</path>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>errorMessage</name>
        <path>errorMessage</path>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>vistaMessage</name>
        <path>vistaMessage</path>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
        <repeat>N</repeat>
      </field>
    </fields>
    <limit>0</limit>
    <IsInFields>Y</IsInFields>
    <IsAFile>N</IsAFile>
    <valueField>rest_result</valueField>
    <shortFileFieldName/>
    <pathFieldName/>
    <hiddenFieldName/>
    <lastModificationTimeFieldName/>
    <uriNameFieldName/>
    <rootUriNameFieldName/>
    <extensionFieldName/>
    <sizeFieldName/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>368</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>No Error on Error, Status, Verify</name>
    <type>Dummy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1024</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>REST Client</name>
    <type>Rest</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <applicationType>JSON</applicationType>
    <method>POST</method>
    <url/>
    <urlInField>Y</urlInField>
    <dynamicMethod>N</dynamicMethod>
    <methodFieldName/>
    <urlField>URL</urlField>
    <bodyField>BODY</bodyField>
    <httpLogin>${WS_USERNAME}</httpLogin>
    <httpPassword>${WS_PASSWORD}</httpPassword>
    <proxyHost/>
    <proxyPort/>
    <preemptive>Y</preemptive>
    <trustStoreFile/>
    <trustStorePassword>Encrypted </trustStorePassword>
    <headers>
      </headers>
    <parameters>
      </parameters>
    <matrixParameters>
      </matrixParameters>
    <result>
      <name>rest_result</name>
      <code/>
      <response_time/>
      <response_header/>
    </result>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>128</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Replace null with "</name>
    <type>ReplaceString</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <in_stream_name>rest_result</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>:null</replace_string>
        <replace_by_string>:""</replace_by_string>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string/>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set MESSAGE to ERROR</name>
    <type>SetValueConstant</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <usevar>N</usevar>
    <fields>
      <field>
        <name>MESSAGE</name>
        <value>&lt;?xml version="1.0" encoding="UTF-8"?>&lt;Message TransportVersion="20170715" DatatypesVersion="20170715" TransactionDomain="SCRIPT" TransactionVersion="20170715" StructuresVersion="20170715" ECLVersion="20170715" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">&lt;Header>&lt;To Qualifier="D">{set_to}&lt;/To>&lt;From Qualifier="P">{set_from}&lt;/From>&lt;MessageID>{set_message_id}&lt;/MessageID>&lt;RelatesToMessageID>{set_relates_to_message_id}&lt;/RelatesToMessageID>&lt;SentTime>{set_sent_time}&lt;/SentTime>&lt;SenderSoftware>&lt;SenderSoftwareDeveloper>VA&lt;/SenderSoftwareDeveloper>&lt;SenderSoftwareProduct>VA-Inbound eRx&lt;/SenderSoftwareProduct>&lt;SenderSoftwareVersionRelease>V4.0&lt;/SenderSoftwareVersionRelease>&lt;/SenderSoftware>&lt;/Header>&lt;Body>&lt;Error>&lt;Code>600&lt;/Code>&lt;DescriptionCode>4000&lt;/DescriptionCode>&lt;Description>Message not delivered. Error sending to pharmacy.&lt;/Description>&lt;/Error>&lt;/Body>&lt;/Message></value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>800</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set MESSAGE to VERIFY</name>
    <type>SetValueConstant</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <usevar>N</usevar>
    <fields>
      <field>
        <name>MESSAGE</name>
        <value>&lt;?xml version="1.0" encoding="UTF-8"?>&lt;Message TransportVersion="20170715" DatatypesVersion="20170715" TransactionDomain="SCRIPT" TransactionVersion="20170715" StructuresVersion="20170715" ECLVersion="20170715" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">&lt;Header>&lt;To Qualifier="D">{set_to}&lt;/To>&lt;From Qualifier="P">{set_from}&lt;/From>&lt;MessageID>{set_message_id}&lt;/MessageID>&lt;RelatesToMessageID>{set_relates_to_message_id}&lt;/RelatesToMessageID>&lt;SentTime>{set_sent_time}&lt;/SentTime>&lt;SenderSoftware>&lt;SenderSoftwareDeveloper>VA&lt;/SenderSoftwareDeveloper>&lt;SenderSoftwareProduct>VA-Inbound eRx&lt;/SenderSoftwareProduct>&lt;SenderSoftwareVersionRelease>V4.0&lt;/SenderSoftwareVersionRelease>&lt;/SenderSoftware>&lt;/Header>&lt;Body>&lt;Verify>&lt;VerifyStatus>&lt;Code>010&lt;/Code>&lt;Description>Received By Pharmacy.&lt;/Description>&lt;/VerifyStatus>&lt;/Verify>&lt;/Body>&lt;/Message></value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set MESSAGE_TYPE to ERROR</name>
    <type>SetValueConstant</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <usevar>N</usevar>
    <fields>
      <field>
        <name>MESSAGE_TYPE</name>
        <value>Error</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>800</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set MESSAGE_TYPE to Verify</name>
    <type>SetValueConstant</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <usevar>N</usevar>
    <fields>
      <field>
        <name>MESSAGE_TYPE</name>
        <value>Verify</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set Message Status to Processing</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>local_erx</connection>
    <execute_each_row>Y</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>Y</replace_variables>
    <quoteString>N</quoteString>
    <sql>update inbound_ncpdp_msg set message_status = '3003' where inbound_ncpdp_msg_id = ${INBOUND_NCPDP_MSG_ID};
commit;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
      <argument>
        <name>RELTOOUTBOUNDNCPDPMSGID</name>
      </argument>
      <argument>
        <name>CANCELRXDENIED</name>
      </argument>
      <argument>
        <name>RUNCOUNT</name>
      </argument>
      <argument>
        <name>success</name>
      </argument>
      <argument>
        <name>vistaMessage</name>
      </argument>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>128</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set Success values</name>
    <type>SetValueField</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>VISTAMESSAGE</name>
        <replaceby>vistaMessage_1</replaceby>
      </field>
      <field>
        <name>SUCCESS</name>
        <replaceby>success_1</replaceby>
      </field>
      <field>
        <name>ERRORMESSAGE</name>
        <replaceby>errorMessage_1</replaceby>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>480</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Switch / Case Send Verify or Not</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fieldname>MESSAGE_TYPE</fieldname>
    <use_contains>N</use_contains>
    <case_value_type>String</case_value_type>
    <case_value_format/>
    <case_value_decimal/>
    <case_value_group/>
    <default_target_step>Set MESSAGE_TYPE to Verify</default_target_step>
    <cases>
      <case>
        <value>Error</value>
        <target_step>Don't Generate a Verify</target_step>
      </case>
      <case>
        <value>Verify</value>
        <target_step>Don't Generate a Verify</target_step>
      </case>
      <case>
        <value>Status</value>
        <target_step>Don't Generate a Verify</target_step>
      </case>
    </cases>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>944</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Switch/Case Error, Status, Verify?</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fieldname>MESSAGE_TYPE</fieldname>
    <use_contains>N</use_contains>
    <case_value_type>String</case_value_type>
    <case_value_format/>
    <case_value_decimal/>
    <case_value_group/>
    <default_target_step>Set MESSAGE_TYPE to ERROR</default_target_step>
    <cases>
      <case>
        <value>Error</value>
        <target_step>No Error on Error, Status, Verify</target_step>
      </case>
      <case>
        <value>Verify</value>
        <target_step>No Error on Error, Status, Verify</target_step>
      </case>
      <case>
        <value>Status</value>
        <target_step>No Error on Error, Status, Verify</target_step>
      </case>
    </cases>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>800</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table input</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>local_erx</connection>
    <sql>
select (select value from app_configuration where key = 'ERX_URL')||
(select value from app_configuration where key = 'TO_VISTA_RS_URI')as url,
'{"xmlInboundMessageId":"'||t.inbound_ncpdp_msg_id||'","division":"'||
(select substr(va_station_id,1,3) from pharmacy where t.pharmacy_id = pharmacy_id)||'"}' as body,
(nvl(extractvalue(xmltype(decode(isxml_func(message_status_details),1,message_status_details,0,'&lt;vistaSends>&lt;/vistaSends>')),'//vistaSends'), 0)) + 1 as runCount,
nvl((select value from app_configuration where key = 'VISTA_RETRY'),0) as retry,
t.inbound_ncpdp_msg_id inbound_ncpdp_msg_id,
t.message_from provider_npi,
(select ncpdp_id from pharmacy where t.pharmacy_id = pharmacy_id) as pharmacy_ncpdpid,
t.message_id as message_id,
t.pharmacy_id as pharmacy_id,
t.message_type as message_type,
'UNK' as message,
'UNK' as message_id_new_1,
'UNK' as message_sent_datetime,
'UNK' as error_code,
'UNK' as error_desc,
'UNK' as message_id_new2,
'' as success,
'' as vistaMessage,
'' as errorMessage,
clinic_id,
(nvl(extractvalue(xmltype(decode(isxml_func(message_status_details),1,message_status_details,0,'&lt;cancelRxDenied>&lt;/cancelRxDenied>')),'//cancelRxDenied'), null)) as cancelRxDenied,
(nvl(extractvalue(xmltype(decode(isxml_func(message_status_details),1,message_status_details,0,'&lt;relToOutboundNcpdpMsgId>&lt;/relToOutboundNcpdpMsgId>')),'//relToOutboundNcpdpMsgId'), null)) as relToOutboundNcpdpMsgId
from inbound_ncpdp_msg t, xmltable('/Message'
    passing t.message
    columns
    clinic_id varchar2(35) path '//Header/From') x
    where t.inbound_ncpdp_msg_id = ${INBOUND_NCPDP_MSG_ID}
--${INBOUND_NCPDP_MSG_ID}</sql>
    <limit>1</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <row-meta/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>32</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>To Vista Check Failure</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>local_erx</connection>
    <execute_each_row>Y</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>Y</replace_variables>
    <quoteString>N</quoteString>
    <sql>update inbound_ncpdp_msg 
set message_status = '3005', message_status_details = '&lt;messageStatusDetails>&lt;relToOutboundNcpdpMsgId>?&lt;/relToOutboundNcpdpMsgId>&lt;cancelRxDenied>?&lt;/cancelRxDenied>&lt;vistaSends>?&lt;/vistaSends>&lt;vistaMessage>'||substr('?',1,1500)||'&lt;/vistaMessage>&lt;hubMessage>'||substr('&lt;![CDATA[ ? ]]&gt;',1,1500)||'&lt;/hubMessage>&lt;/messageStatusDetails>'
where inbound_ncpdp_msg_id = ${INBOUND_NCPDP_MSG_ID};

commit;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
      <argument>
        <name>RELTOOUTBOUNDNCPDPMSGID</name>
      </argument>
      <argument>
        <name>CANCELRXDENIED</name>
      </argument>
      <argument>
        <name>RUNCOUNT</name>
      </argument>
      <argument>
        <name>VISTAMESSAGE</name>
      </argument>
      <argument>
        <name>ERRORMESSAGE</name>
      </argument>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>To Vista Check Failure Allow Retry</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>local_erx</connection>
    <execute_each_row>Y</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>Y</replace_variables>
    <quoteString>N</quoteString>
    <sql>update inbound_ncpdp_msg set message_status = '3004', message_status_details = '&lt;messageStatusDetails>&lt;relToOutboundNcpdpMsgId>?&lt;/relToOutboundNcpdpMsgId>&lt;cancelRxDenied>?&lt;/cancelRxDenied>&lt;vistaSends>?&lt;/vistaSends>&lt;/messageStatusDetails>'
where inbound_ncpdp_msg_id = ${INBOUND_NCPDP_MSG_ID};
commit;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
      <argument>
        <name>RELTOOUTBOUNDNCPDPMSGID</name>
      </argument>
      <argument>
        <name>CANCELRXDENIED</name>
      </argument>
      <argument>
        <name>RUNCOUNT</name>
      </argument>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>To Vista Check Success</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>local_erx</connection>
    <execute_each_row>Y</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>Y</replace_variables>
    <quoteString>N</quoteString>
    <sql>update inbound_ncpdp_msg 
set message_status = '3002', message_status_details = '&lt;messageStatusDetails>&lt;relToOutboundNcpdpMsgId>?&lt;/relToOutboundNcpdpMsgId>&lt;cancelRxDenied>?&lt;/cancelRxDenied>&lt;vistaSends>?&lt;/vistaSends>&lt;vistaMessage>'||substr('? - ?',1,1500)||'&lt;/vistaMessage>&lt;/messageStatusDetails>'
where inbound_ncpdp_msg_id = ${INBOUND_NCPDP_MSG_ID};

commit;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
      <argument>
        <name>RELTOOUTBOUNDNCPDPMSGID</name>
      </argument>
      <argument>
        <name>CANCELRXDENIED</name>
      </argument>
      <argument>
        <name>RUNCOUNT</name>
      </argument>
      <argument>
        <name>success</name>
      </argument>
      <argument>
        <name>vistaMessage</name>
      </argument>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>752</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Write to log</name>
    <type>WriteToLog</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <loglevel>log_level_rowlevel</loglevel>
    <displayHeader>Y</displayHeader>
    <limitRows>N</limitRows>
    <limitRowsNumber>-1</limitRowsNumber>
    <logmessage/>
    <fields>
      <field>
        <name>errorMessage</name>
      </field>
      <field>
        <name>rest_result</name>
      </field>
      <field>
        <name>vistaMessage</name>
      </field>
      <field>
        <name>success</name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Write to log 2</name>
    <type>WriteToLog</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <loglevel>log_level_basic</loglevel>
    <displayHeader>Y</displayHeader>
    <limitRows>N</limitRows>
    <limitRowsNumber>-1</limitRowsNumber>
    <logmessage>LOG!!!!!</logmessage>
    <fields>
      <field>
        <name>MESSAGE_ID</name>
      </field>
      <field>
        <name>MESSAGE_SENT_DATETIME</name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1056</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>check for retry</name>
    <type>FilterRows</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>To Vista Check Failure</send_true_to>
    <send_false_to>To Vista Check Failure Allow Retry</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>RUNCOUNT</leftvalue>
        <function>&gt;=</function>
        <rightvalue>RETRY</rightvalue>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>368</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>check for success</name>
    <type>FilterRows</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>To Vista Check Success</send_true_to>
    <send_false_to>remove special chars from errorMessage</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <conditions>
          <condition>
            <negated>N</negated>
            <leftvalue>success</leftvalue>
            <function>=</function>
            <rightvalue/>
            <value>
              <name>constant</name>
              <type>String</type>
              <text>true</text>
              <length>-1</length>
              <precision>-1</precision>
              <isnull>N</isnull>
              <mask/>
            </value>
          </condition>
          <condition>
            <negated>N</negated>
            <operator>OR</operator>
            <conditions>
              <condition>
                <negated>N</negated>
                <leftvalue>VISTAMESSAGE</leftvalue>
                <function>=</function>
                <rightvalue/>
                <value>
                  <name>constant</name>
                  <type>String</type>
                  <text>This message already exists. Changes must occur via a change request XML message.</text>
                  <length>-1</length>
                  <precision>-1</precision>
                  <isnull>N</isnull>
                  <mask/>
                </value>
              </condition>
              <condition>
                <negated>N</negated>
                <operator>AND</operator>
                <leftvalue>RUNCOUNT</leftvalue>
                <function>&gt;</function>
                <rightvalue/>
                <value>
                  <name>constant</name>
                  <type>BigNumber</type>
                  <text>1.0</text>
                  <length>-1</length>
                  <precision>-1</precision>
                  <isnull>N</isnull>
                  <mask>######0.0###################;-######0.0###################</mask>
                </value>
              </condition>
            </conditions>
          </condition>
        </conditions>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>remove special chars from errorMessage</name>
    <type>ReplaceString</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <in_stream_name>ERRORMESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>yes</use_regex>
        <replace_string>\p{Punct}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string/>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
    <error>
      <source_step>JSON Input 2</source_step>
      <target_step>check for retry</target_step>
      <is_enabled>Y</is_enabled>
      <nr_valuename/>
      <descriptions_valuename/>
      <fields_valuename/>
      <codes_valuename/>
      <max_errors/>
      <max_pct_errors/>
      <min_pct_rows/>
    </error>
    <error>
      <source_step>REST Client</source_step>
      <target_step>check for retry</target_step>
      <is_enabled>Y</is_enabled>
      <nr_valuename/>
      <descriptions_valuename/>
      <fields_valuename/>
      <codes_valuename/>
      <max_errors/>
      <max_pct_errors/>
      <min_pct_rows/>
    </error>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>

<transformation>
  <info>
    <name>IBDTV_SendMessageToVista_TRN</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/inbound_vista_delivery</directory>
    <parameters>
      <parameter>
        <name>INBOUND_NCPDP_MSG_ID</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>RETRY</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>RUNCOUNT</name>
        <default_value/>
        <description/>
      </parameter>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
      <slaveserver>
        <name>master1</name>
        <hostname>localhost</hostname>
        <port>8080</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>slave3</name>
        <hostname>vaauserxappsqa2.aac.va.gov</hostname>
        <port>8083</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>slave5</name>
        <hostname>vaauserxappsqa2.aac.va.gov</hostname>
        <port>8085</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>admin</created_user>
    <created_date>2017/03/26 23:43:30.000</created_date>
    <modified_user>admin</modified_user>
    <modified_date>2020/12/08 09:10:03.000</modified_date>
    <key_for_session_key/>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>local_erx</name>
    <server>${DB_HOST_NAME}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${DB_NAME}</database>
    <port>${DB_PORT}</port>
    <username>${DB_USERNAME}</username>
    <password>${DB_PASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>INITIAL_POOL_SIZE</code>
        <attribute>1</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MAXIMUM_POOL_SIZE</code>
        <attribute>10</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${DB_PORT}</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>Y</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>check for retry</from>
      <to>To Vista Check Failure Allow Retry</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set MESSAGE to ERROR</from>
      <to>Get Date_Time</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Format Date-Time</from>
      <to>Generate random value</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Date_Time</from>
      <to>Format Date-Time</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Concat Date-Time and Random Value for New Message ID</from>
      <to>Write to log 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Inject Values into NCPDP Error Message Template</from>
      <to>Insert to OUTBOUND_NCPDP_MSG</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JSON Input 2</from>
      <to>Write to log</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Concat Date-Time and Random Value for New Message ID</from>
      <to>Inject Values into NCPDP Error Message Template</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Generate random value</from>
      <to>ABS</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>ABS</from>
      <to>Concat Date-Time and Random Value for New Message ID</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set MESSAGE_TYPE to ERROR</from>
      <to>Set MESSAGE to ERROR</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>check for retry</from>
      <to>To Vista Check Failure</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set MESSAGE to VERIFY</from>
      <to>Get Date_Time</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>To Vista Check Success</from>
      <to>Switch / Case Send Verify or Not</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case Send Verify or Not</from>
      <to>Set MESSAGE_TYPE to Verify</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case Send Verify or Not</from>
      <to>Don't Generate a Verify</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JSON Input 2</from>
      <to>Set Success values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set Success values</from>
      <to>check for success</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>To Vista Check Failure</from>
      <to>Switch/Case Error, Status, Verify?</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch/Case Error, Status, Verify?</from>
      <to>No Error on Error, Status, Verify</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch/Case Error, Status, Verify?</from>
      <to>Set MESSAGE_TYPE to ERROR</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>check for success</from>
      <to>remove special chars from errorMessage</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>remove special chars from errorMessage</from>
      <to>To Vista Check Failure</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set MESSAGE_TYPE to Verify</from>
      <to>Set MESSAGE to VERIFY</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>REST Client</from>
      <to>Replace null with "</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Replace null with "</from>
      <to>JSON Input 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Table input</from>
      <to>Set Message Status to Processing</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set Message Status to Processing</from>
      <to>REST Client</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>check for success</from>
      <to>To Vista Check Success</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JSON Input 2</from>
      <to>check for retry</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>REST Client</from>
      <to>check for retry</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>ABS</name>
    <type>Calculator</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <failIfNoFile>N</failIfNoFile>
    <calculation>
      <field_name>MESSAGE_ID3</field_name>
      <calc_type>ABS</calc_type>
      <field_a>MESSAGE_ID2</field_a>
      <field_b/>
      <field_c/>
      <value_type>Integer</value_type>
      <value_length>-1</value_length>
      <value_precision>-1</value_precision>
      <remove>N</remove>
      <conversion_mask>0</conversion_mask>
      <decimal_symbol>.</decimal_symbol>
      <grouping_symbol>,</grouping_symbol>
      <currency_symbol/>
    </calculation>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1440</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Concat Date-Time and Random Value for New Message ID</name>
    <type>ConcatFields</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <separator>.0</separator>
    <enclosure/>
    <enclosure_forced>N</enclosure_forced>
    <enclosure_fix_disabled>N</enclosure_fix_disabled>
    <header>N</header>
    <footer>N</footer>
    <format>DOS</format>
    <compression>None</compression>
    <encoding/>
    <endedLine/>
    <fileNameInField>N</fileNameInField>
    <fileNameField/>
    <create_parent_folder>Y</create_parent_folder>
    <file>
      <name/>
      <servlet_output>N</servlet_output>
      <do_not_open_new_file_init>N</do_not_open_new_file_init>
      <extention>txt</extention>
      <append>N</append>
      <split>N</split>
      <haspartno>N</haspartno>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <add_to_result_filenames>Y</add_to_result_filenames>
      <pad>N</pad>
      <fast_dump>N</fast_dump>
      <splitevery/>
    </file>
    <fields>
      <field>
        <name>MESSAGE_ID_DATETIME</name>
        <type>None</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>MESSAGE_ID3</name>
        <type>None</type>
        <format>0000000000</format>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
    </fields>
    <ConcatFields>
      <targetFieldName>MESSAGE_ID_NEW_1</targetFieldName>
      <targetFieldLength>35</targetFieldLength>
      <removeSelectedFields>N</removeSelectedFields>
    </ConcatFields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Don't Generate a Verify</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1056</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Format Date-Time</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>
var d = new Date();

var output = date2str(TODAY_DATE_TIME, "MMddyyyy.HH.mm.sss");

var output2 = d.toISOString();

</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>output</name>
        <rename>MESSAGE_ID_DATETIME</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>output2</name>
        <rename>MESSAGE_SENT_DATETIME2</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1280</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Generate random value</name>
    <type>RandomValue</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>MESSAGE_ID2</name>
        <type>random integer</type>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1440</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Date_Time</name>
    <type>SystemInfo</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>TODAY_DATE_TIME</name>
        <type>system date (variable)</type>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1088</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Inject Values into NCPDP Error Message Template</name>
    <type>ReplaceString</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_to}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>CLINIC_ID</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_from}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>PHARMACY_NCPDPID</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_message_id}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>MESSAGE_ID_NEW_1</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_relates_to_message_id}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>MESSAGE_ID</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_sent_time}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>MESSAGE_SENT_DATETIME2</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_error_code}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>ERROR_CODE</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_description_code}</replace_string>
        <replace_by_string>007</replace_by_string>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string/>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
      <field>
        <in_stream_name>MESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>{set_description}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string>ERROR_DESC</replace_field_by_string>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>800</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert to OUTBOUND_NCPDP_MSG</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>local_erx</connection>
    <execute_each_row>Y</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>N</replace_variables>
    <quoteString>N</quoteString>
    <sql>insert into outbound_ncpdp_msg (message_id,rel_to_message_id,  message, message_type, message_status, pharmacy_id,received_date,script_version)
values ('?','?','?','?','0000','?', SYSDATE, '2017071');
commit;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
      <argument>
        <name>MESSAGE_ID_NEW_1</name>
      </argument>
      <argument>
        <name>MESSAGE_ID</name>
      </argument>
      <argument>
        <name>MESSAGE</name>
      </argument>
      <argument>
        <name>MESSAGE_TYPE</name>
      </argument>
      <argument>
        <name>PHARMACY_ID</name>
      </argument>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>544</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>JSON Input 2</name>
    <type>JsonInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <include>N</include>
    <include_field/>
    <rownum>N</rownum>
    <addresultfile>N</addresultfile>
    <readurl>N</readurl>
    <removeSourceField>N</removeSourceField>
    <IsIgnoreEmptyFile>Y</IsIgnoreEmptyFile>
    <doNotFailIfNoFile>Y</doNotFailIfNoFile>
    <ignoreMissingPath>N</ignoreMissingPath>
    <defaultPathLeafToNull>Y</defaultPathLeafToNull>
    <rownum_field/>
    <file>
      <name/>
      <filemask/>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
    </file>
    <fields>
      <field>
        <name>success</name>
        <path>success</path>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>errorMessage</name>
        <path>errorMessage</path>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>vistaMessage</name>
        <path>vistaMessage</path>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
        <repeat>N</repeat>
      </field>
    </fields>
    <limit>0</limit>
    <IsInFields>Y</IsInFields>
    <IsAFile>N</IsAFile>
    <valueField>rest_result</valueField>
    <shortFileFieldName/>
    <pathFieldName/>
    <hiddenFieldName/>
    <lastModificationTimeFieldName/>
    <uriNameFieldName/>
    <rootUriNameFieldName/>
    <extensionFieldName/>
    <sizeFieldName/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>464</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>No Error on Error, Status, Verify</name>
    <type>Dummy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1136</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>REST Client</name>
    <type>Rest</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <applicationType>JSON</applicationType>
    <method>POST</method>
    <url/>
    <urlInField>Y</urlInField>
    <dynamicMethod>N</dynamicMethod>
    <methodFieldName/>
    <urlField>URL</urlField>
    <bodyField>BODY</bodyField>
    <httpLogin>${WS_USERNAME}</httpLogin>
    <httpPassword>${WS_PASSWORD}</httpPassword>
    <proxyHost/>
    <proxyPort/>
    <preemptive>Y</preemptive>
    <trustStoreFile/>
    <trustStorePassword>Encrypted </trustStorePassword>
    <headers>
      </headers>
    <parameters>
      </parameters>
    <matrixParameters>
      </matrixParameters>
    <result>
      <name>rest_result</name>
      <code/>
      <response_time/>
      <response_header/>
    </result>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>272</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Replace null with "</name>
    <type>ReplaceString</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <in_stream_name>rest_result</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>:null</replace_string>
        <replace_by_string>:""</replace_by_string>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string/>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>368</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set MESSAGE to ERROR</name>
    <type>SetValueConstant</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <usevar>N</usevar>
    <fields>
      <field>
        <name>MESSAGE</name>
        <value>&lt;?xml version="1.0" encoding="UTF-8"?>&lt;Message TransportVersion="20170715" DatatypesVersion="20170715" TransactionDomain="SCRIPT" TransactionVersion="20170715" StructuresVersion="20170715" ECLVersion="20170715" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">&lt;Header>&lt;To Qualifier="D">{set_to}&lt;/To>&lt;From Qualifier="P">{set_from}&lt;/From>&lt;MessageID>{set_message_id}&lt;/MessageID>&lt;RelatesToMessageID>{set_relates_to_message_id}&lt;/RelatesToMessageID>&lt;SentTime>{set_sent_time}&lt;/SentTime>&lt;SenderSoftware>&lt;SenderSoftwareDeveloper>VA&lt;/SenderSoftwareDeveloper>&lt;SenderSoftwareProduct>VA-Inbound eRx&lt;/SenderSoftwareProduct>&lt;SenderSoftwareVersionRelease>V4.0&lt;/SenderSoftwareVersionRelease>&lt;/SenderSoftware>&lt;/Header>&lt;Body>&lt;Error>&lt;Code>600&lt;/Code>&lt;DescriptionCode>4000&lt;/DescriptionCode>&lt;Description>Message not delivered. Error sending to pharmacy.&lt;/Description>&lt;/Error>&lt;/Body>&lt;/Message></value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set MESSAGE to VERIFY</name>
    <type>SetValueConstant</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <usevar>N</usevar>
    <fields>
      <field>
        <name>MESSAGE</name>
        <value>&lt;?xml version="1.0" encoding="UTF-8"?>&lt;Message TransportVersion="20170715" DatatypesVersion="20170715" TransactionDomain="SCRIPT" TransactionVersion="20170715" StructuresVersion="20170715" ECLVersion="20170715" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">&lt;Header>&lt;To Qualifier="D">{set_to}&lt;/To>&lt;From Qualifier="P">{set_from}&lt;/From>&lt;MessageID>{set_message_id}&lt;/MessageID>&lt;RelatesToMessageID>{set_relates_to_message_id}&lt;/RelatesToMessageID>&lt;SentTime>{set_sent_time}&lt;/SentTime>&lt;SenderSoftware>&lt;SenderSoftwareDeveloper>VA&lt;/SenderSoftwareDeveloper>&lt;SenderSoftwareProduct>VA-Inbound eRx&lt;/SenderSoftwareProduct>&lt;SenderSoftwareVersionRelease>V4.0&lt;/SenderSoftwareVersionRelease>&lt;/SenderSoftware>&lt;/Header>&lt;Body>&lt;Verify>&lt;VerifyStatus>&lt;Code>010&lt;/Code>&lt;Description>Received By Pharmacy.&lt;/Description>&lt;/VerifyStatus>&lt;/Verify>&lt;/Body>&lt;/Message></value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1280</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set MESSAGE_TYPE to ERROR</name>
    <type>SetValueConstant</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <usevar>N</usevar>
    <fields>
      <field>
        <name>MESSAGE_TYPE</name>
        <value>Error</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set MESSAGE_TYPE to Verify</name>
    <type>SetValueConstant</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <usevar>N</usevar>
    <fields>
      <field>
        <name>MESSAGE_TYPE</name>
        <value>Verify</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1280</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set Message Status to Processing</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>local_erx</connection>
    <execute_each_row>Y</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>Y</replace_variables>
    <quoteString>N</quoteString>
    <sql>update inbound_ncpdp_msg 
set message_status = '3003'
where inbound_ncpdp_msg_id = ${INBOUND_NCPDP_MSG_ID};

commit;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
      <argument>
        <name>RELTOOUTBOUNDNCPDPMSGID</name>
      </argument>
      <argument>
        <name>CANCELRXDENIED</name>
      </argument>
      <argument>
        <name>RUNCOUNT</name>
      </argument>
      <argument>
        <name>success</name>
      </argument>
      <argument>
        <name>vistaMessage</name>
      </argument>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set Success values</name>
    <type>SetValueField</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>VISTAMESSAGE</name>
        <replaceby>vistaMessage_1</replaceby>
      </field>
      <field>
        <name>SUCCESS</name>
        <replaceby>success_1</replaceby>
      </field>
      <field>
        <name>ERRORMESSAGE</name>
        <replaceby>errorMessage_1</replaceby>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>592</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Switch / Case Send Verify or Not</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fieldname>MESSAGE_TYPE</fieldname>
    <use_contains>N</use_contains>
    <case_value_type>String</case_value_type>
    <case_value_format/>
    <case_value_decimal/>
    <case_value_group/>
    <default_target_step>Set MESSAGE_TYPE to Verify</default_target_step>
    <cases>
      <case>
        <value>Error</value>
        <target_step>Don't Generate a Verify</target_step>
      </case>
      <case>
        <value>Verify</value>
        <target_step>Don't Generate a Verify</target_step>
      </case>
      <case>
        <value>Status</value>
        <target_step>Don't Generate a Verify</target_step>
      </case>
    </cases>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1056</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Switch/Case Error, Status, Verify?</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fieldname>MESSAGE_TYPE</fieldname>
    <use_contains>N</use_contains>
    <case_value_type>String</case_value_type>
    <case_value_format/>
    <case_value_decimal/>
    <case_value_group/>
    <default_target_step>Set MESSAGE_TYPE to ERROR</default_target_step>
    <cases>
      <case>
        <value>Error</value>
        <target_step>No Error on Error, Status, Verify</target_step>
      </case>
      <case>
        <value>Verify</value>
        <target_step>No Error on Error, Status, Verify</target_step>
      </case>
      <case>
        <value>Status</value>
        <target_step>No Error on Error, Status, Verify</target_step>
      </case>
    </cases>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table input</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>local_erx</connection>
    <sql>select (select value from app_configuration where key = 'ERX_URL')||
(select value from app_configuration where key = 'TO_VISTA_RS_URI')as url,
'{"xmlInboundMessageId":"'||t.inbound_ncpdp_msg_id||'","division":"'||
(select substr(va_station_id,1,3) from pharmacy where t.pharmacy_id = pharmacy_id)||'"}' as body,
(nvl(extractvalue(xmltype(decode(isxml_func(message_status_details),1,message_status_details,0,'&lt;vistaSends>&lt;/vistaSends>')),'//vistaSends'), 0)) + 1 as runCount,
nvl((select value from app_configuration where key = 'VISTA_RETRY'),0) as retry,
t.inbound_ncpdp_msg_id inbound_ncpdp_msg_id,
t.message_from provider_npi,
(select ncpdp_id from pharmacy where t.pharmacy_id = pharmacy_id) as pharmacy_ncpdpid,
t.message_id as message_id,
t.pharmacy_id as pharmacy_id,
t.message_type as message_type,
'UNK' as message,
'UNK' as message_id_new_1,
'UNK' as message_sent_datetime,
'UNK' as error_code,
'UNK' as error_desc,
'UNK' as message_id_new2,
'' as success,
'' as vistaMessage,
'' as errorMessage,
clinic_id,
(nvl(extractvalue(xmltype(decode(isxml_func(message_status_details),1,message_status_details,0,'&lt;cancelRxDenied>&lt;/cancelRxDenied>')),'//cancelRxDenied'), null)) as cancelRxDenied,
(nvl(extractvalue(xmltype(decode(isxml_func(message_status_details),1,message_status_details,0,'&lt;relToOutboundNcpdpMsgId>&lt;/relToOutboundNcpdpMsgId>')),'//relToOutboundNcpdpMsgId'), null)) as relToOutboundNcpdpMsgId
from inbound_ncpdp_msg t, xmltable('/Message'
    passing t.message
    columns
    clinic_id varchar2(35) path '//Header/From') x
    where t.inbound_ncpdp_msg_id = ${INBOUND_NCPDP_MSG_ID}

--${INBOUND_NCPDP_MSG_ID}</sql>
    <limit>1</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>16</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>To Vista Check Failure</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>local_erx</connection>
    <execute_each_row>Y</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>Y</replace_variables>
    <quoteString>N</quoteString>
    <sql>update inbound_ncpdp_msg 
set message_status = '3005', message_status_details = '&lt;messageStatusDetails>&lt;relToOutboundNcpdpMsgId>?&lt;/relToOutboundNcpdpMsgId>&lt;cancelRxDenied>?&lt;/cancelRxDenied>&lt;vistaSends>?&lt;/vistaSends>&lt;vistaMessage>'||substr('?',1,1500)||'&lt;/vistaMessage>&lt;hubMessage>'||substr('&lt;![CDATA[ ? ]]&gt;',1,1500)||'&lt;/hubMessage>&lt;/messageStatusDetails>'
where inbound_ncpdp_msg_id = ${INBOUND_NCPDP_MSG_ID};

commit;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
      <argument>
        <name>RELTOOUTBOUNDNCPDPMSGID</name>
      </argument>
      <argument>
        <name>CANCELRXDENIED</name>
      </argument>
      <argument>
        <name>RUNCOUNT</name>
      </argument>
      <argument>
        <name>VISTAMESSAGE</name>
      </argument>
      <argument>
        <name>ERRORMESSAGE</name>
      </argument>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>To Vista Check Failure Allow Retry</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>local_erx</connection>
    <execute_each_row>Y</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>Y</replace_variables>
    <quoteString>N</quoteString>
    <sql>update inbound_ncpdp_msg set message_status = '3004', message_status_details = '&lt;messageStatusDetails>&lt;relToOutboundNcpdpMsgId>?&lt;/relToOutboundNcpdpMsgId>&lt;cancelRxDenied>?&lt;/cancelRxDenied>&lt;vistaSends>?&lt;/vistaSends>&lt;/messageStatusDetails>'
where inbound_ncpdp_msg_id = ${INBOUND_NCPDP_MSG_ID};
commit;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
      <argument>
        <name>RELTOOUTBOUNDNCPDPMSGID</name>
      </argument>
      <argument>
        <name>CANCELRXDENIED</name>
      </argument>
      <argument>
        <name>RUNCOUNT</name>
      </argument>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>320</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>To Vista Check Success</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>local_erx</connection>
    <execute_each_row>Y</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>Y</replace_variables>
    <quoteString>N</quoteString>
    <sql>update inbound_ncpdp_msg 
set message_status = '3002', message_status_details = '&lt;messageStatusDetails>&lt;relToOutboundNcpdpMsgId>?&lt;/relToOutboundNcpdpMsgId>&lt;cancelRxDenied>?&lt;/cancelRxDenied>&lt;vistaSends>?&lt;/vistaSends>&lt;vistaMessage>'||substr('? - ?',1,1500)||'&lt;/vistaMessage>&lt;/messageStatusDetails>'
where inbound_ncpdp_msg_id = ${INBOUND_NCPDP_MSG_ID};

commit;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
      <argument>
        <name>RELTOOUTBOUNDNCPDPMSGID</name>
      </argument>
      <argument>
        <name>CANCELRXDENIED</name>
      </argument>
      <argument>
        <name>RUNCOUNT</name>
      </argument>
      <argument>
        <name>success</name>
      </argument>
      <argument>
        <name>vistaMessage</name>
      </argument>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Write to log</name>
    <type>WriteToLog</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <loglevel>log_level_basic</loglevel>
    <displayHeader>Y</displayHeader>
    <limitRows>N</limitRows>
    <limitRowsNumber>-1</limitRowsNumber>
    <logmessage/>
    <fields>
      <field>
        <name>errorMessage</name>
      </field>
      <field>
        <name>rest_result</name>
      </field>
      <field>
        <name>vistaMessage</name>
      </field>
      <field>
        <name>success</name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>528</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Write to log 2</name>
    <type>WriteToLog</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <loglevel>log_level_basic</loglevel>
    <displayHeader>Y</displayHeader>
    <limitRows>N</limitRows>
    <limitRowsNumber>-1</limitRowsNumber>
    <logmessage>LOG!!!!!</logmessage>
    <fields>
      <field>
        <name>MESSAGE_ID</name>
      </field>
      <field>
        <name>MESSAGE_SENT_DATETIME</name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>check for retry</name>
    <type>FilterRows</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>To Vista Check Failure</send_true_to>
    <send_false_to>To Vista Check Failure Allow Retry</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>RUNCOUNT</leftvalue>
        <function>&gt;=</function>
        <rightvalue>RETRY</rightvalue>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>464</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>check for success</name>
    <type>FilterRows</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>To Vista Check Success</send_true_to>
    <send_false_to>remove special chars from errorMessage</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <conditions>
          <condition>
            <negated>N</negated>
            <leftvalue>success</leftvalue>
            <function>=</function>
            <rightvalue/>
            <value>
              <name>constant</name>
              <type>String</type>
              <text>true</text>
              <length>-1</length>
              <precision>-1</precision>
              <isnull>N</isnull>
              <mask/>
            </value>
          </condition>
          <condition>
            <negated>N</negated>
            <operator>OR</operator>
            <conditions>
              <condition>
                <negated>N</negated>
                <leftvalue>VISTAMESSAGE</leftvalue>
                <function>=</function>
                <rightvalue/>
                <value>
                  <name>constant</name>
                  <type>String</type>
                  <text>This message already exists. Changes must occur via a change request XML message.</text>
                  <length>-1</length>
                  <precision>-1</precision>
                  <isnull>N</isnull>
                  <mask/>
                </value>
              </condition>
              <condition>
                <negated>N</negated>
                <operator>AND</operator>
                <leftvalue>RUNCOUNT</leftvalue>
                <function>&gt;</function>
                <rightvalue/>
                <value>
                  <name>constant</name>
                  <type>BigNumber</type>
                  <text>1.0</text>
                  <length>-1</length>
                  <precision>-1</precision>
                  <isnull>N</isnull>
                  <mask>######0.0###################;-######0.0###################</mask>
                </value>
              </condition>
            </conditions>
          </condition>
        </conditions>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>remove special chars from errorMessage</name>
    <type>ReplaceString</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <in_stream_name>ERRORMESSAGE</in_stream_name>
        <out_stream_name/>
        <use_regex>yes</use_regex>
        <replace_string>\p{Punct}</replace_string>
        <replace_by_string/>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string/>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
    <error>
      <source_step>JSON Input 2</source_step>
      <target_step>check for retry</target_step>
      <is_enabled>Y</is_enabled>
      <nr_valuename/>
      <descriptions_valuename/>
      <fields_valuename/>
      <codes_valuename/>
      <max_errors/>
      <max_pct_errors/>
      <min_pct_rows/>
    </error>
    <error>
      <source_step>REST Client</source_step>
      <target_step>check for retry</target_step>
      <is_enabled>Y</is_enabled>
      <nr_valuename/>
      <descriptions_valuename/>
      <fields_valuename/>
      <codes_valuename/>
      <max_errors/>
      <max_pct_errors/>
      <min_pct_rows/>
    </error>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>

</transformations>
<jobs>
<job>
  <name>InboundDeliverToVistaMbM_JOB</name>
  <description/>
  <extended_description/>
  <job_version/>
  <job_status>0</job_status>
  <directory>/inbound_vista_delivery</directory>
  <created_user>admin</created_user>
  <created_date>2017/03/26 23:43:30.000</created_date>
  <modified_user>admin</modified_user>
  <modified_date>2021/01/25 13:35:46.000</modified_date>
  <parameters>
    <parameter>
      <name>INBOUND_NCPDP_MSG_ID</name>
      <default_value/>
      <description/>
    </parameter>
  </parameters>
  <connection>
    <name>local_erx</name>
    <server>${DB_HOST_NAME}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${DB_NAME}</database>
    <port>${DB_PORT}</port>
    <username>${DB_USERNAME}</username>
    <password>${DB_PASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>INITIAL_POOL_SIZE</code>
        <attribute>1</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MAXIMUM_POOL_SIZE</code>
        <attribute>10</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${DB_PORT}</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>Y</attribute>
      </attribute>
    </attributes>
  </connection>
  <slaveservers>
    <slaveserver>
      <name>master1</name>
      <hostname>localhost</hostname>
      <port>8080</port>
      <webAppName/>
      <username>cluster</username>
      <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>Y</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>slave3</name>
      <hostname>vaauserxappsqa2.aac.va.gov</hostname>
      <port>8083</port>
      <webAppName/>
      <username>cluster</username>
      <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>slave5</name>
      <hostname>vaauserxappsqa2.aac.va.gov</hostname>
      <port>8085</port>
      <webAppName/>
      <username>cluster</username>
      <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
  </slaveservers>
  <job-log-table>
    <connection/>
    <schema/>
    <table/>
    <size_limit_lines/>
    <interval/>
    <timeout_days/>
    <field>
      <id>ID_JOB</id>
      <enabled>Y</enabled>
      <name>ID_JOB</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>JOBNAME</name>
    </field>
    <field>
      <id>STATUS</id>
      <enabled>Y</enabled>
      <name>STATUS</name>
    </field>
    <field>
      <id>LINES_READ</id>
      <enabled>Y</enabled>
      <name>LINES_READ</name>
    </field>
    <field>
      <id>LINES_WRITTEN</id>
      <enabled>Y</enabled>
      <name>LINES_WRITTEN</name>
    </field>
    <field>
      <id>LINES_UPDATED</id>
      <enabled>Y</enabled>
      <name>LINES_UPDATED</name>
    </field>
    <field>
      <id>LINES_INPUT</id>
      <enabled>Y</enabled>
      <name>LINES_INPUT</name>
    </field>
    <field>
      <id>LINES_OUTPUT</id>
      <enabled>Y</enabled>
      <name>LINES_OUTPUT</name>
    </field>
    <field>
      <id>LINES_REJECTED</id>
      <enabled>Y</enabled>
      <name>LINES_REJECTED</name>
    </field>
    <field>
      <id>ERRORS</id>
      <enabled>Y</enabled>
      <name>ERRORS</name>
    </field>
    <field>
      <id>STARTDATE</id>
      <enabled>Y</enabled>
      <name>STARTDATE</name>
    </field>
    <field>
      <id>ENDDATE</id>
      <enabled>Y</enabled>
      <name>ENDDATE</name>
    </field>
    <field>
      <id>LOGDATE</id>
      <enabled>Y</enabled>
      <name>LOGDATE</name>
    </field>
    <field>
      <id>DEPDATE</id>
      <enabled>Y</enabled>
      <name>DEPDATE</name>
    </field>
    <field>
      <id>REPLAYDATE</id>
      <enabled>Y</enabled>
      <name>REPLAYDATE</name>
    </field>
    <field>
      <id>LOG_FIELD</id>
      <enabled>Y</enabled>
      <name>LOG_FIELD</name>
    </field>
    <field>
      <id>EXECUTING_SERVER</id>
      <enabled>N</enabled>
      <name>EXECUTING_SERVER</name>
    </field>
    <field>
      <id>EXECUTING_USER</id>
      <enabled>N</enabled>
      <name>EXECUTING_USER</name>
    </field>
    <field>
      <id>START_JOB_ENTRY</id>
      <enabled>N</enabled>
      <name>START_JOB_ENTRY</name>
    </field>
    <field>
      <id>CLIENT</id>
      <enabled>N</enabled>
      <name>CLIENT</name>
    </field>
  </job-log-table>
  <jobentry-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <field>
      <id>ID_BATCH</id>
      <enabled>Y</enabled>
      <name>ID_BATCH</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>LOG_DATE</id>
      <enabled>Y</enabled>
      <name>LOG_DATE</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>TRANSNAME</name>
    </field>
    <field>
      <id>JOBENTRYNAME</id>
      <enabled>Y</enabled>
      <name>STEPNAME</name>
    </field>
    <field>
      <id>LINES_READ</id>
      <enabled>Y</enabled>
      <name>LINES_READ</name>
    </field>
    <field>
      <id>LINES_WRITTEN</id>
      <enabled>Y</enabled>
      <name>LINES_WRITTEN</name>
    </field>
    <field>
      <id>LINES_UPDATED</id>
      <enabled>Y</enabled>
      <name>LINES_UPDATED</name>
    </field>
    <field>
      <id>LINES_INPUT</id>
      <enabled>Y</enabled>
      <name>LINES_INPUT</name>
    </field>
    <field>
      <id>LINES_OUTPUT</id>
      <enabled>Y</enabled>
      <name>LINES_OUTPUT</name>
    </field>
    <field>
      <id>LINES_REJECTED</id>
      <enabled>Y</enabled>
      <name>LINES_REJECTED</name>
    </field>
    <field>
      <id>ERRORS</id>
      <enabled>Y</enabled>
      <name>ERRORS</name>
    </field>
    <field>
      <id>RESULT</id>
      <enabled>Y</enabled>
      <name>RESULT</name>
    </field>
    <field>
      <id>NR_RESULT_ROWS</id>
      <enabled>Y</enabled>
      <name>NR_RESULT_ROWS</name>
    </field>
    <field>
      <id>NR_RESULT_FILES</id>
      <enabled>Y</enabled>
      <name>NR_RESULT_FILES</name>
    </field>
    <field>
      <id>LOG_FIELD</id>
      <enabled>N</enabled>
      <name>LOG_FIELD</name>
    </field>
    <field>
      <id>COPY_NR</id>
      <enabled>N</enabled>
      <name>COPY_NR</name>
    </field>
  </jobentry-log-table>
  <channel-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <field>
      <id>ID_BATCH</id>
      <enabled>Y</enabled>
      <name>ID_BATCH</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>LOG_DATE</id>
      <enabled>Y</enabled>
      <name>LOG_DATE</name>
    </field>
    <field>
      <id>LOGGING_OBJECT_TYPE</id>
      <enabled>Y</enabled>
      <name>LOGGING_OBJECT_TYPE</name>
    </field>
    <field>
      <id>OBJECT_NAME</id>
      <enabled>Y</enabled>
      <name>OBJECT_NAME</name>
    </field>
    <field>
      <id>OBJECT_COPY</id>
      <enabled>Y</enabled>
      <name>OBJECT_COPY</name>
    </field>
    <field>
      <id>REPOSITORY_DIRECTORY</id>
      <enabled>Y</enabled>
      <name>REPOSITORY_DIRECTORY</name>
    </field>
    <field>
      <id>FILENAME</id>
      <enabled>Y</enabled>
      <name>FILENAME</name>
    </field>
    <field>
      <id>OBJECT_ID</id>
      <enabled>Y</enabled>
      <name>OBJECT_ID</name>
    </field>
    <field>
      <id>OBJECT_REVISION</id>
      <enabled>Y</enabled>
      <name>OBJECT_REVISION</name>
    </field>
    <field>
      <id>PARENT_CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>PARENT_CHANNEL_ID</name>
    </field>
    <field>
      <id>ROOT_CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>ROOT_CHANNEL_ID</name>
    </field>
  </channel-log-table>
  <pass_batchid>N</pass_batchid>
  <shared_objects_file/>
  <entries>
    <entry>
      <name>Job Finished Success</name>
      <description/>
      <type>SUCCESS</type>
      <attributes/>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>880</xloc>
      <yloc>160</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>START</name>
      <description/>
      <type>SPECIAL</type>
      <attributes/>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>Y</repeat>
      <schedulerType>0</schedulerType>
      <intervalSeconds>10</intervalSeconds>
      <intervalMinutes>0</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>80</xloc>
      <yloc>160</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>IBDTV_SendMessageToVistaMbM_TRN</name>
      <description/>
      <type>TRANS</type>
      <attributes/>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>IBDTV_SendMessageToVistaMbM_TRN</transname>
      <directory>/inbound_vista_delivery</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>Y</params_from_previous>
      <exec_per_row>Y</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration>Pentaho local</run_configuration>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
        <parameter>
          <name>INBOUND_NCPDP_MSG_ID</name>
          <stream_name>INBOUND_NCPDP_MSG_ID</stream_name>
          <value/>
        </parameter>
        <parameter>
          <name>RUNCOUNT</name>
          <stream_name>RUNCOUNT</stream_name>
          <value/>
        </parameter>
        <parameter>
          <name>RETRY</name>
          <stream_name>RETRY</stream_name>
          <value/>
        </parameter>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>656</xloc>
      <yloc>160</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Check for Messages Deliver to Dedicated MBM</name>
      <description/>
      <type>WAIT_FOR_SQL</type>
      <attributes/>
      <connection>local_erx</connection>
      <schemaname/>
      <tablename/>
      <success_condition>rows_count_greater</success_condition>
      <rows_count_value>0</rows_count_value>
      <is_custom_sql>Y</is_custom_sql>
      <is_usevars>Y</is_usevars>
      <custom_sql>  select * from(  select inbound_ncpdp_msg_id ,
    '3003' as vistaop_delivery_in_process,
    (nvl(extractvalue(xmltype(decode(isxml_func(message_status_details),1,message_status_details,0,'&lt;vistaSendRetry>&lt;/vistaSendRetry>')),'//vistaSendRetry'), 0)) + 1 as runCount,
nvl((select value from app_configuration where key = 'VISTA_RETRY'),0) as retry
from inbound_ncpdp_msg 
where message_status in ('3001','3004')
and patient_chk_status in ('0002','0003','0101','0102','0103','0108','0109')
and provider_chk_status in ('2001','2002','2003','2005')
and drug_chk_status in ('1001','1002','1003','1005')
and message_type in ('NewRx','RxRenewalResponse','RxChangeResponse','Error', 'CancelRx')
and received_date between sysdate - nvl((select value from app_configuration where key = 'TO_VISTA_LB_DYS'),4) and sysdate
and pharmacy_id in (${DEDICATED_VISTA_DLVRY_JOB_SITE_LIST})
order by inbound_ncpdp_msg_id)
where rownum &lt;= ${VISTA_DLVRY_JOB_BATCH_SIZE}</custom_sql>
      <add_rows_result>Y</add_rows_result>
      <maximum_timeout>0</maximum_timeout>
      <check_cycle_time>${VISTA_JOB_CHECK_CYCLE_TIME}</check_cycle_time>
      <success_on_timeout>N</success_on_timeout>
      <clear_result_rows>N</clear_result_rows>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>352</xloc>
      <yloc>160</yloc>
      <attributes_kjc/>
    </entry>
  </entries>
  <hops>
    <hop>
      <from>Check for Messages Deliver to Dedicated MBM</from>
      <to>IBDTV_SendMessageToVistaMbM_TRN</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>IBDTV_SendMessageToVistaMbM_TRN</from>
      <to>Job Finished Success</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>Check for Messages Deliver to Dedicated MBM</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
  </hops>
  <notepads>
  </notepads>
  <attributes/>
</job>

<job>
  <name>InboundDeliverToVista_JOB</name>
  <description/>
  <extended_description/>
  <job_version/>
  <job_status>0</job_status>
  <directory>/inbound_vista_delivery</directory>
  <created_user>admin</created_user>
  <created_date>2017/03/26 23:43:30.000</created_date>
  <modified_user>admin</modified_user>
  <modified_date>2021/01/25 13:35:20.000</modified_date>
  <parameters>
    <parameter>
      <name>INBOUND_NCPDP_MSG_ID</name>
      <default_value/>
      <description/>
    </parameter>
  </parameters>
  <connection>
    <name>local_erx</name>
    <server>${DB_HOST_NAME}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${DB_NAME}</database>
    <port>${DB_PORT}</port>
    <username>${DB_USERNAME}</username>
    <password>${DB_PASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>INITIAL_POOL_SIZE</code>
        <attribute>1</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MAXIMUM_POOL_SIZE</code>
        <attribute>10</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${DB_PORT}</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>Y</attribute>
      </attribute>
    </attributes>
  </connection>
  <slaveservers>
    <slaveserver>
      <name>master1</name>
      <hostname>localhost</hostname>
      <port>8080</port>
      <webAppName/>
      <username>cluster</username>
      <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>Y</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>slave3</name>
      <hostname>vaauserxappsqa2.aac.va.gov</hostname>
      <port>8083</port>
      <webAppName/>
      <username>cluster</username>
      <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>slave5</name>
      <hostname>vaauserxappsqa2.aac.va.gov</hostname>
      <port>8085</port>
      <webAppName/>
      <username>cluster</username>
      <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
  </slaveservers>
  <job-log-table>
    <connection/>
    <schema/>
    <table/>
    <size_limit_lines/>
    <interval/>
    <timeout_days/>
    <field>
      <id>ID_JOB</id>
      <enabled>Y</enabled>
      <name>ID_JOB</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>JOBNAME</name>
    </field>
    <field>
      <id>STATUS</id>
      <enabled>Y</enabled>
      <name>STATUS</name>
    </field>
    <field>
      <id>LINES_READ</id>
      <enabled>Y</enabled>
      <name>LINES_READ</name>
    </field>
    <field>
      <id>LINES_WRITTEN</id>
      <enabled>Y</enabled>
      <name>LINES_WRITTEN</name>
    </field>
    <field>
      <id>LINES_UPDATED</id>
      <enabled>Y</enabled>
      <name>LINES_UPDATED</name>
    </field>
    <field>
      <id>LINES_INPUT</id>
      <enabled>Y</enabled>
      <name>LINES_INPUT</name>
    </field>
    <field>
      <id>LINES_OUTPUT</id>
      <enabled>Y</enabled>
      <name>LINES_OUTPUT</name>
    </field>
    <field>
      <id>LINES_REJECTED</id>
      <enabled>Y</enabled>
      <name>LINES_REJECTED</name>
    </field>
    <field>
      <id>ERRORS</id>
      <enabled>Y</enabled>
      <name>ERRORS</name>
    </field>
    <field>
      <id>STARTDATE</id>
      <enabled>Y</enabled>
      <name>STARTDATE</name>
    </field>
    <field>
      <id>ENDDATE</id>
      <enabled>Y</enabled>
      <name>ENDDATE</name>
    </field>
    <field>
      <id>LOGDATE</id>
      <enabled>Y</enabled>
      <name>LOGDATE</name>
    </field>
    <field>
      <id>DEPDATE</id>
      <enabled>Y</enabled>
      <name>DEPDATE</name>
    </field>
    <field>
      <id>REPLAYDATE</id>
      <enabled>Y</enabled>
      <name>REPLAYDATE</name>
    </field>
    <field>
      <id>LOG_FIELD</id>
      <enabled>Y</enabled>
      <name>LOG_FIELD</name>
    </field>
    <field>
      <id>EXECUTING_SERVER</id>
      <enabled>N</enabled>
      <name>EXECUTING_SERVER</name>
    </field>
    <field>
      <id>EXECUTING_USER</id>
      <enabled>N</enabled>
      <name>EXECUTING_USER</name>
    </field>
    <field>
      <id>START_JOB_ENTRY</id>
      <enabled>N</enabled>
      <name>START_JOB_ENTRY</name>
    </field>
    <field>
      <id>CLIENT</id>
      <enabled>N</enabled>
      <name>CLIENT</name>
    </field>
  </job-log-table>
  <jobentry-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <field>
      <id>ID_BATCH</id>
      <enabled>Y</enabled>
      <name>ID_BATCH</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>LOG_DATE</id>
      <enabled>Y</enabled>
      <name>LOG_DATE</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>TRANSNAME</name>
    </field>
    <field>
      <id>JOBENTRYNAME</id>
      <enabled>Y</enabled>
      <name>STEPNAME</name>
    </field>
    <field>
      <id>LINES_READ</id>
      <enabled>Y</enabled>
      <name>LINES_READ</name>
    </field>
    <field>
      <id>LINES_WRITTEN</id>
      <enabled>Y</enabled>
      <name>LINES_WRITTEN</name>
    </field>
    <field>
      <id>LINES_UPDATED</id>
      <enabled>Y</enabled>
      <name>LINES_UPDATED</name>
    </field>
    <field>
      <id>LINES_INPUT</id>
      <enabled>Y</enabled>
      <name>LINES_INPUT</name>
    </field>
    <field>
      <id>LINES_OUTPUT</id>
      <enabled>Y</enabled>
      <name>LINES_OUTPUT</name>
    </field>
    <field>
      <id>LINES_REJECTED</id>
      <enabled>Y</enabled>
      <name>LINES_REJECTED</name>
    </field>
    <field>
      <id>ERRORS</id>
      <enabled>Y</enabled>
      <name>ERRORS</name>
    </field>
    <field>
      <id>RESULT</id>
      <enabled>Y</enabled>
      <name>RESULT</name>
    </field>
    <field>
      <id>NR_RESULT_ROWS</id>
      <enabled>Y</enabled>
      <name>NR_RESULT_ROWS</name>
    </field>
    <field>
      <id>NR_RESULT_FILES</id>
      <enabled>Y</enabled>
      <name>NR_RESULT_FILES</name>
    </field>
    <field>
      <id>LOG_FIELD</id>
      <enabled>N</enabled>
      <name>LOG_FIELD</name>
    </field>
    <field>
      <id>COPY_NR</id>
      <enabled>N</enabled>
      <name>COPY_NR</name>
    </field>
  </jobentry-log-table>
  <channel-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <field>
      <id>ID_BATCH</id>
      <enabled>Y</enabled>
      <name>ID_BATCH</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>LOG_DATE</id>
      <enabled>Y</enabled>
      <name>LOG_DATE</name>
    </field>
    <field>
      <id>LOGGING_OBJECT_TYPE</id>
      <enabled>Y</enabled>
      <name>LOGGING_OBJECT_TYPE</name>
    </field>
    <field>
      <id>OBJECT_NAME</id>
      <enabled>Y</enabled>
      <name>OBJECT_NAME</name>
    </field>
    <field>
      <id>OBJECT_COPY</id>
      <enabled>Y</enabled>
      <name>OBJECT_COPY</name>
    </field>
    <field>
      <id>REPOSITORY_DIRECTORY</id>
      <enabled>Y</enabled>
      <name>REPOSITORY_DIRECTORY</name>
    </field>
    <field>
      <id>FILENAME</id>
      <enabled>Y</enabled>
      <name>FILENAME</name>
    </field>
    <field>
      <id>OBJECT_ID</id>
      <enabled>Y</enabled>
      <name>OBJECT_ID</name>
    </field>
    <field>
      <id>OBJECT_REVISION</id>
      <enabled>Y</enabled>
      <name>OBJECT_REVISION</name>
    </field>
    <field>
      <id>PARENT_CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>PARENT_CHANNEL_ID</name>
    </field>
    <field>
      <id>ROOT_CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>ROOT_CHANNEL_ID</name>
    </field>
  </channel-log-table>
  <pass_batchid>N</pass_batchid>
  <shared_objects_file/>
  <entries>
    <entry>
      <name>START</name>
      <description/>
      <type>SPECIAL</type>
      <attributes/>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>Y</repeat>
      <schedulerType>0</schedulerType>
      <intervalSeconds>10</intervalSeconds>
      <intervalMinutes>0</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>64</xloc>
      <yloc>64</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>IBDTV_SendMessageToVista_TRN</name>
      <description/>
      <type>TRANS</type>
      <attributes/>
      <specification_method>rep_ref</specification_method>
      <trans_object_id>8</trans_object_id>
      <filename/>
      <transname>IBDTV_SendMessageToVista_TRN</transname>
      <directory>/inbound_vista_delivery</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>Y</params_from_previous>
      <exec_per_row>Y</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration/>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
        <parameter>
          <name>INBOUND_NCPDP_MSG_ID</name>
          <stream_name>INBOUND_NCPDP_MSG_ID</stream_name>
          <value/>
        </parameter>
        <parameter>
          <name>RUNCOUNT</name>
          <stream_name>RUNCOUNT</stream_name>
          <value/>
        </parameter>
        <parameter>
          <name>RETRY</name>
          <stream_name>RETRY</stream_name>
          <value/>
        </parameter>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>400</xloc>
      <yloc>64</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Check for Messages to Deliver</name>
      <description/>
      <type>WAIT_FOR_SQL</type>
      <attributes/>
      <connection>local_erx</connection>
      <schemaname/>
      <tablename/>
      <success_condition>rows_count_greater</success_condition>
      <rows_count_value>0</rows_count_value>
      <is_custom_sql>Y</is_custom_sql>
      <is_usevars>Y</is_usevars>
      <custom_sql>  select * from(  select inbound_ncpdp_msg_id ,
    '3003' as vistaop_delivery_in_process,
    (nvl(extractvalue(xmltype(decode(isxml_func(message_status_details),1,message_status_details,0,'&lt;vistaSendRetry>&lt;/vistaSendRetry>')),'//vistaSendRetry'), 0)) + 1 as runCount,
nvl((select value from app_configuration where key = 'VISTA_RETRY'),0) as retry
from inbound_ncpdp_msg 
where message_status in ('3001','3004')
and patient_chk_status in ('0002','0003','0101','0102','0103','0108','0109')
and provider_chk_status in ('2001','2002','2003','2005')
and drug_chk_status in ('1001','1002','1003','1005')
and message_type in ('NewRx','RxRenewalResponse','RxChangeResponse','Error', 'CancelRx')
and received_date between sysdate - nvl((select value from app_configuration where key = 'TO_VISTA_LB_DYS'),4) and sysdate
and pharmacy_id not in (${DEDICATED_VISTA_DLVRY_JOB_SITE_LIST})
order by inbound_ncpdp_msg_id)
where rownum &lt;= ${VISTA_DLVRY_JOB_BATCH_SIZE}</custom_sql>
      <add_rows_result>Y</add_rows_result>
      <maximum_timeout>0</maximum_timeout>
      <check_cycle_time>${VISTA_JOB_CHECK_CYCLE_TIME}</check_cycle_time>
      <success_on_timeout>N</success_on_timeout>
      <clear_result_rows>N</clear_result_rows>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>208</xloc>
      <yloc>64</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Job Finished Success</name>
      <description/>
      <type>SUCCESS</type>
      <attributes/>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>576</xloc>
      <yloc>64</yloc>
      <attributes_kjc/>
    </entry>
  </entries>
  <hops>
    <hop>
      <from>IBDTV_SendMessageToVista_TRN</from>
      <to>Job Finished Success</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>Check for Messages to Deliver</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>Check for Messages to Deliver</from>
      <to>IBDTV_SendMessageToVista_TRN</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
  </hops>
  <notepads>
  </notepads>
  <attributes/>
</job>

</jobs>
</repository>

